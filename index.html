<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Games</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
        }
        #gameCanvas {
            border: 2px solid #000;
            background-color: #fff;
            margin-top: 20px;
        }
        .game-buttons button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>Canvas Games</h1>
    <div class="game-buttons">
        <button onclick="startNumberBaseball()">숫자야구</button>
        <button onclick="startTicTacToe()">틱택토</button>
        <button onclick="startMemoryGame()">메모리 게임</button>
    </div>
    <canvas id="gameCanvas" width="600" height="400"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function generateRandomNumber() {
            let digits = new Set();
            while (digits.size < 4) {
                digits.add(Math.floor(Math.random() * 10));
            }
            return Array.from(digits).join('');
        }

        function checkGuess(guess, target) {
            let strikes = 0;
            let balls = 0;
            for (let i = 0; i < 4; i++) {
                if (guess[i] === target[i]) {
                    strikes++;
                } else if (target.includes(guess[i])) {
                    balls++;
                }
            }
            return { strikes, balls };
        }
        // 숫자야구
        function startNumberBaseball() {
            clearCanvas();
            let targetNumber = generateRandomNumber();
            let attempts = 0;
            let input;
            do {
                input = prompt("4자리 숫자를 입력하세요:");
                if (input && input.length === 4 && /^[0-9]{4}$/.test(input)) {
                    let result = checkGuess(input, targetNumber);
                    attempts++;
                    ctx.fillText(`${input} -> ${result.strikes} 스트라이크, ${result.balls} 볼`, 150, 200 + attempts * 20);
                    if (result.strikes === 4) {
                        ctx.fillText(`축하합니다! ${attempts}번 만에 정답입니다!`, 150, 300);
                        break;
                    }
                } else {
                    alert("올바른 4자리 숫자를 입력하세요.");
                }
            } while (input !== targetNumber);
        }

        // 틱택토
        function startTicTacToe() {
            clearCanvas();
            let userSymbol = prompt("O 또는 X를 선택하세요:").toUpperCase();
            let computerSymbol = userSymbol === 'O' ? 'X' : 'O';
            let board = Array(9).fill(null);
            let moves = [];

            function drawBoard() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                for (let i = 0; i < 3; i++) {
                    for (let j = 0; j < 3; j++) {
                        ctx.strokeRect(j * 100 + 150, i * 100 + 50, 100, 100);
                        let symbol = board[i * 3 + j];
                        if (symbol) {
                            ctx.fillText(symbol, j * 100 + 185, i * 100 + 110);
                        }
                    }
                }
            }

            function checkWin(symbol) {
                const winningCombinations = [
                    [0, 1, 2], [3, 4, 5], [6, 7, 8],
                    [0, 3, 6], [1, 4, 7], [2, 5, 8],
                    [0, 4, 8], [2, 4, 6]
                ];
                return winningCombinations.some(combination =>
                    combination.every(index => board[index] === symbol)
                );
            }

            function computerMove() {
                let emptyCells = board.map((v, i) => v === null ? i : null).filter(v => v !== null);
                if (emptyCells.length > 0) {
                    let move = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                    board[move] = computerSymbol;
                    moves.push(move);
                    if (moves.length > 3) {
                        board[moves.shift()] = null;
                    }
                }
            }

            canvas.addEventListener('click', function(event) {
                let x = Math.floor((event.offsetX - 150) / 100);
                let y = Math.floor((event.offsetY - 50) / 100);
                let index = y * 3 + x;
                if (board[index] === null) {
                    board[index] = userSymbol;
                    moves.push(index);
                    if (moves.length > 3) {
                        board[moves.shift()] = null;
                    }
                    if (checkWin(userSymbol)) {
                        alert("사용자가 승리했습니다!");
                        return;
                    }
                    computerMove();
                    if (checkWin(computerSymbol)) {
                        alert("컴퓨터가 승리했습니다!");
                        return;
                    }
                    drawBoard();
                }
            });
            drawBoard();
        }

        // 메모리 게임
        function startMemoryGame() {
            clearCanvas();
            let symbols = ['🍎', '🍌', '🍇', '🍉', '🍓', '🍎', '🍌', '🍇', '🍉', '🍓'];
            symbols = symbols.sort(() => Math.random() - 0.5);
            let flipped = Array(10).fill(false);
            let selected = [];

            function drawCards() {
                for (let i = 0; i < 10; i++) {
                    let x = (i % 5) * 100 + 50;
                    let y = Math.floor(i / 5) * 150 + 50;
                    ctx.strokeRect(x, y, 80, 100);
                    if (flipped[i]) {
                        ctx.fillText(symbols[i], x + 30, y + 60);
                    } else {
                        ctx.fillText("❓", x + 30, y + 60);
                    }
                }
            }

            canvas.addEventListener('click', function(event) {
                let x = Math.floor((event.offsetX - 50) / 100);
                let y = Math.floor((event.offsetY - 50) / 150);
                let index = y * 5 + x;
                if (!flipped[index] && selected.length < 2) {
                    flipped[index] = true;
                    selected.push(index);
                    drawCards();
                    if (selected.length === 2) {
                        setTimeout(() => {
                            if (symbols[selected[0]] !== symbols[selected[1]]) {
                                flipped[selected[0]] = false;
                                flipped[selected[1]] = false;
                            }
                            selected = [];
                            drawCards();
                            if (flipped.every(val => val)) {
                                alert("축하합니다! 모든 카드를 맞추셨습니다.");
                            }
                        }, 1000);
                    }
                }
            });
            drawCards();
        }
    </script>
</body>
</html>
